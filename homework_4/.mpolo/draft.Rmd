### Ex 8.4

*Refer to Exercise 8.1. Construct a classification tree, and prune strongly until the tree uses a single explanatory variable. Which crabs were predicted to have satellites? How does the proportion of correct predictions compare with the more complex tree in Figure 8.2?*

**Solution**

Exercise 8.1 is about the `Crabs` data file. Let's explore it:

```{r}
data = read.table("https://stat4ds.rwth-aachen.de/data/Crabs.dat", header=TRUE)
head(data, n=3) #show first 3 rows
```
\
Let's construct the tree:

```{r}
library(rpart)
library(rpart.plot)
tree = rpart(
  formula = y ~ weight + width + color + spine,
  method="class", #class because y is binary
  data=data)
rpart.plot(tree, extra=2) #extra=2 to show proportion of correct predictions
```
\
Let's print the complexity parameter table to figure out where to prune the tree:

```{r}
printcp(tree, digits=2) #digits=2 to round values
```
\
The table above shows that, to get a tree with a number of splits `nsplit` $=1$ (and so a single explanatory variable), we must prune with a complexity parameter `CP` $\approx 0.081$. Let's prune it:

```{r}
pruned = prune(tree, cp=0.081)
rpart.plot(pruned, extra=2)
```
\
The crabs predicted to have satellites ($y=1$) are the ones with width $\ge 26$ cm.

The proportion of correct prediction is ${44+77 \over 173} = 0.699$, that is lower than the one of the more complex tree in Figure 8.2, which is reported to be $0.751$.
