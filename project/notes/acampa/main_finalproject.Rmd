---
title: "final_project_stat"
author: "Agustin Campagnolo"
date: "2023-01-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#### REFS
[1] https://www.analyticsvidhya.com/blog/2020/10/feature-selection-techniques-in-machine-learning/




- dispersion: 
- n.a.
- outlier
- correlation
  - X -> remove multi-collinearity
  - Y
- Normalization/Standardization
  - coefficients scale (+explainability)

### Feature Selection


Load Dataset

```{r}
path <- '../..' # go up two folders
filename = '/winequality-white.csv'

data = read.csv(paste(path,filename, sep = ""), sep = ';') # load data

names(data) # view variable names
dim(data) # view datframe size [rows, columns]
head(data) # view first lines
str(data) # structure of dataframe
summary(data) # descriptive statistics
```
Cleaning exploration

```{r}
colSums(is.na(data)) # count Na values by columns
```
## Data Exploration

- Inspect every variable

```{r}

cols <- names(data)

for (col in cols) {
  tab <- pivot_longer(data, col)
  ggplot(data_long1, aes(x = value)) +
  geom_histogram() + 
  facet_wrap(name ~ ., scales = "free")
}


```


### Correlation Coefficient

Correlation is a measure of the linear relationship of 2 or more variables. Through correlation, we can predict one variable from the other. The logic behind using correlation for feature selection is that the good variables are highly correlated with the target. Furthermore, variables should be correlated with the target but should be uncorrelated among themselves.

If two variables are correlated, we can predict one from the other. Therefore, if two features are correlated, the model only really needs one of them, as the second one does not add additional information. We will use the Pearson Correlation here.[1]


```{r}
### install.packages("GGally")             # Install GGally package
library("GGally")

ggp = ggpairs(data, progress = ggmatrix_progress())  # draw pair plots of dataframe
print(ggp)  # no progress bar
```

```{r}
### install.packages("tidyr")              # Install & load tidyr
library("tidyr")

cols <- names(data)
#del_cols <- (, "free.sulfur.dioxide", "alcohol", "quality", "fixed.acidity")
cols <- cols[cols != "total.sulfur.dioxide"];
cols <- cols[cols != "free.sulfur.dioxide"];
cols <- cols[cols != "residual.sugar"];
cols <- cols[cols != "alcohol"];
cols <- cols[cols != "quality"];
cols <- cols[cols != "fixed.acidity"];

data_long1 <- pivot_longer(data,    # Reshape data frame
                            c("total.sulfur.dioxide", "free.sulfur.dioxide", "residual.sugar"))

ggplot(data_long1,                  # Draw boxplots
       aes(x = value, fill = name)) + geom_boxplot()


data_long2 <- pivot_longer(data,    # Reshape data frame
                            c("alcohol", "quality", "fixed.acidity"))
ggplot(data_long2,                  # Draw boxplots
       aes(x = value, fill = name)) + geom_boxplot()

data_long3 <- pivot_longer(data,    # Reshape data frame
                            c("volatile.acidity", "sulphates", "citric.acid", "pH"))
ggplot(data_long3,                  # Draw boxplots
       aes(x = value, fill = name)) + geom_boxplot()

data_long4 <- pivot_longer(data,    # Reshape data frame
                            c("density"))
ggplot(data_long4,                  # Draw boxplots
       aes(x = value, fill = name)) + geom_boxplot()

data_long5 <- pivot_longer(data,    # Reshape data frame
                            c("chlorides"))
ggplot(data_long5,                  # Draw boxplots
       aes(x = value, fill = name)) + geom_boxplot()
```

```{r}
ggplot(data_long1,                    # Draw histograms
       aes(x = value)) +
  geom_histogram() + 
  facet_wrap(name ~ ., scales = "free")

ggplot(data_long2,                    # Draw histograms
       aes(x = value)) +
  geom_histogram() + 
  facet_wrap(name ~ ., scales = "free")

ggplot(data_long3,                    # Draw histograms
       aes(x = value)) +
  geom_histogram() + 
  facet_wrap(name ~ ., scales = "free")

ggplot(data_long4,                    # Draw histograms
       aes(x = value)) +
  geom_histogram() + 
  facet_wrap(name ~ ., scales = "free")

ggplot(data_long5,                    # Draw histograms
       aes(x = value)) +
  geom_histogram() + 
  facet_wrap(name ~ ., scales = "free")

data_response <- pivot_longer(data,    # Reshape data frame
                            c("quality"))
ggplot(data_response,                    # Draw histograms
       aes(x = value)) +
  geom_histogram()

unique(data$quality)
```



```{r}
ggpairs(data)  # draw pair plots of dataframe

gplot <- GGally::ggpairs(data)
gplot$nrow <- 1
gplot$yAxisLabels <- a$yAxisLabels[1]
print(gplot)

```

